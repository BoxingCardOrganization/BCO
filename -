import React, { useState } from 'react'
import { api } from '../../lib/api'
import { formatCurrency } from '../../lib/format'
import { getTierName, calculateScore } from '../../lib/scoring' // ⬅️ removed getTierMultiplier import

const tierColor = (tier)=>({
  1: 'bg-gray-100 text-gray-800',
  2: 'bg-blue-100 text-blue-800',
  3: 'bg-purple-100 text-purple-800',
  4: 'bg-orange-100 text-orange-800'
}[tier] || 'bg-gray-100 text-gray-800')

export default function Composer({ userFV, userTier, onPosted, autoFocus = false }){
  const [value, setValue] = useState('')
  const [posting, setPosting] = useState(false)

  const handleSubmit = async (e)=>{
    e.preventDefault()
    if (!value.trim() || posting) return
    try{
      setPosting(true)
      // keep scoring logic internal (no UI exposure)
      const score = calculateScore(userFV, userTier, 0, 0)
      const msg = await api.postMessage({
        content: value.trim(),
        fightfolioValue: userFV,
        fanTier: userTier,
        score
      })
      onPosted?.(msg)
      setValue('')
    }catch(e){
      alert('Failed to post message: ' + e.message)
    }finally{
      setPosting(false)
    }
  }

  return (
    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <form onSubmit={handleSubmit}>
        <div className="mb-4">
          <label htmlFor="message" className="block text-sm font-medium text-gray-700 mb-2">
            Share your thoughts ($1.00 to post)
          </label>
          {/* Added id="composer" for deep-link focus; k*


